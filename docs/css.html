<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=960, initial-scale=1.0" />
    <title>CSS版</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      /* X座標のモーション管理用変数 */
      @property --tx {
        syntax: "<length>";
        inherits: false;
        initial-value: 0px;
      }

      /* Y座標のモーション管理用変数 */
      @property --ty {
        syntax: "<length>";
        inherits: false;
        initial-value: 0px;
      }

      /* 水平方向のスケールのモーション管理用変数 */
      @property --sx {
        syntax: "<number>";
        inherits: false;
        initial-value: 1;
      }

      /* 垂直方向のスケールのモーション管理用変数 */
      @property --sy {
        syntax: "<number>";
        inherits: false;
        initial-value: 1;
      }

      /* 回転のモーション管理用変数 */
      @property --angle {
        syntax: "<angle>";
        inherits: false;
        initial-value: 0deg;
      }

      :root {
        /* 強めのイージング */
        --ease-quart-out: cubic-bezier(0.77, 0, 0.175, 1);
        /* Backのイージング */
        --ease-back-out: cubic-bezier(0.175, 0.885, 0.32, 1.4);
      }

      .dot {
        transform: translate(var(--tx), var(--ty)) rotate(var(--angle))
          scaleX(var(--sx)) scaleY(var(--sy));
      }

      .dotEx {
        transform: translate(var(--tx), var(--ty)) rotate(var(--angle))
          scaleX(var(--sx));
      }

      @keyframes move-tx {
        0% {
          --tx: var(--tx-from);
        }
        100% {
          --tx: var(--tx-to);
        }
      }

      @keyframes move-ty {
        0% {
          --ty: var(--ty-from);
        }
        100% {
          --ty: var(--ty-to);
        }
      }

      @keyframes scale {
        0% {
          --sx: var(--s-from);
          --sy: var(--s-from);
        }
        100% {
          --sx: var(--s-to);
          --sy: var(--s-to);
        }
      }

      @keyframes scaleX {
        0% {
          --sx: var(--sx-from);
        }
        100% {
          --sx: var(--sx-to);
        }
      }

      @keyframes scaleY {
        0% {
          --sy: var(--sy-from);
        }
        100% {
          --sy: var(--sy-to);
        }
      }
    </style>
    <script src="adjust.js"></script>
  </head>
  <body>
    <div id="root">
      <div id="move_01" class="demo-container">
        <div class="dot dot-100 ghost"></div>
        <div class="dot dot-100"></div>
        <p>水平と垂直の移動を、異なるイージングにして凝った感を</p>
        <style>
          @scope {
            .dot {
              --tx-from: 100px;
              --ty-from: 75px;
              --tx-to: 600px;
              --ty-to: 250px;

              &:nth-child(1) {
                animation: move-tx 1.5s var(--ease-quart-out) infinite,
                  move-ty 1.5s var(--ease-quart-out) infinite;
              }
              &:nth-child(2) {
                animation: move-tx 1.5s var(--ease-quart-out) infinite,
                  move-ty 1.5s var(--ease-back-out) infinite;
              }
            }
          }
        </style>
      </div>
      <div id="move_02" class="demo-container">
        <div class="dot dot-200 ghost"></div>
        <div class="dot dot-200"></div>
        <p>垂直移動を異なるイージングにして、奥行き感をだす</p>
        <style>
          @scope {
            .dot {
              --tx-from: 50px;
              --ty-from: 50px;
              --tx-to: 500px;
              --ty-to: 200px;
              --s-from: 0.1;
              --s-to: 1;
              &:nth-child(1) {
                animation:
                  move-tx 2s var(--ease-quart-out) infinite,
                  move-ty 2s var(--ease-quart-out) infinite,
                  scale 2s var(--ease-quart-out) infinite;
              }
              &:nth-child(2) {
                animation:
                  move-tx 2s var(--ease-quart-out) infinite,
                  /* 垂直方向の動きだけ異なるイージングに */
                  move-ty 2s var(--ease-back-out) infinite,
                  scale 2s var(--ease-quart-out) infinite;
              }
            }
          }
        </style>
      </div>
      <div id="move_03" class="demo-container">
        <div class="dot dot-100 ghost"></div>
        <div class="dot dot-100"></div>
        <p>垂直移動を異なるイージングにして、ジグザグの動きに</p>
        <style>
          @scope {
            .dot {
              --tx-from: 100px;
              --ty-from: 100px;
              --tx-to: 600px;
              --ty-to: 250px;

              &:nth-child(1) {
                animation:
                  move-tx 1.75s var(--ease-quart-out) infinite,
                  move-ty 1.75s var(--ease-quart-out) infinite;
              }
              &:nth-child(2) {
                animation:
                  move-tx 1.75s var(--ease-quart-out) infinite,
                  /* あえてリニアに */
                  move-ty 1.75s linear infinite;
              }
            }
          }
        </style>
      </div>
      <div id="expand" class="demo-container">
        <div class="dotEx">
          <div class="dotExInnerX">
            <div class="dotExInnerY">
              <div class="dot dot-200"></div>
            </div>
          </div>
        </div>
        <div class="dotEx">
          <div class="dotExInnerX">
            <div class="dotExInnerY">
              <div class="dot dot-200"></div>
            </div>
          </div>
        </div>
        <p>拡大時に、垂直と水平のタイミングをずらす</p>
        <style>
          @scope {
            .dotEx {
              /* ボヨンボヨンのイージング */
              --ease-elastic-out: linear(
                0,
                0.2178 2.1%,
                1.1144 8.49%,
                1.2959 10.7%,
                1.3463 11.81%,
                1.3705 12.94%,
                1.3726,
                1.3643 14.48%,
                1.3151 16.2%,
                1.0317 21.81%,
                0.941 24.01%,
                0.8912 25.91%,
                0.8694 27.84%,
                0.8698 29.21%,
                0.8824 30.71%,
                1.0122 38.33%,
                1.0357,
                1.046 42.71%,
                1.0416 45.7%,
                0.9961 53.26%,
                0.9839 57.54%,
                0.9853 60.71%,
                1.0012 68.14%,
                1.0056 72.24%,
                0.9981 86.66%,
                1
              );

              --sx-from: 0.3;
              --sy-from: 0.3;
              --sx-to: 1;
              --sy-to: 1;
              position: absolute;

              .dotExInnerX {
                transform: scaleX(var(--sx));
                animation: scaleX 2s var(--ease-elastic-out) infinite;
              }
              .dotExInnerY {
                transform: scaleY(var(--sy));
                animation: scaleY 2s var(--ease-elastic-out) infinite;
              }

              &:nth-child(1) {
                left: 200px;
                top: 200px;
              }

              &:nth-child(2) {
                left: 500px;
                top: 200px;

                .dotExInnerY {
                  animation-delay: 0.1s;
                }
              }
            }
          }
        </style>
      </div>
      <div id="rotate" class="demo-container">
        <div class="dot dot-100 rotate"></div>
        <div class="dot dot-100 rotate"></div>
        <p>横移動に、回転の動作を加える</p>
        <style>
          @scope {
            @keyframes rotate-seq {
              0% {
                --angle: 0deg;
              }
              10% {
                --angle: -80deg;
              }
              30% {
                --angle: -80deg;
              }
              50% {
                --angle: 30deg;
              }
              100% {
                --angle: 0deg;
              }
            }
            .dot {
              &:nth-child(1) {
                --tx-from: 100px;
                --tx-to: 600px;
                --ty: 125px;
                animation:
                  move-tx 2.0s cubic-bezier(0.87, 0, 0.13, 1) infinite;
              }
              &:nth-child(2) {
                --tx-from: 100px;
                --tx-to: 600px;
                --ty: 275px;
                animation:
                  /* 回転の予備動作を含める */
                  rotate-seq 2.0s infinite,
                  move-tx 2.0s cubic-bezier(0.87, 0, 0.13, 1) infinite;
              }
            }
          }
        </style>
      </div>
      <div id="drop" class="demo-container">
        <div class="dotEx">
          <div class="dot dot-100"></div>
        </div>

        <div class="dotEx">
          <div class="dot dot-100"></div>
        </div>
        <p>落ちて跳ねるときに、伸縮の動作を加える</p>
        <style>
          @scope {
            /* 跳ねるのイージング */
            --ease-bounce-out: linear(
              0,
              0.004,
              0.016,
              0.035,
              0.063 9.1%,
              0.141,
              0.25,
              0.391,
              0.563,
              0.765,
              1,
              0.891,
              0.813 45.5%,
              0.785,
              0.766,
              0.754,
              0.75,
              0.754,
              0.766,
              0.785,
              0.813 63.6%,
              0.891,
              1 72.7%,
              0.973,
              0.953,
              0.941,
              0.938,
              0.941,
              0.953,
              0.973,
              1,
              0.988,
              0.984,
              0.988,
              1
            );

            .dotEx {
              position: absolute;

              --ty-from: -300px;
              --ty-to: 0;

              transform-origin: center 100%;
              animation: move-ty 2s var(--ease-bounce-out);

              &:nth-child(1) {
                left: 200px;
                top: 300px;
              }
              &:nth-child(2) {
                left: 500px;
                top: 300px;
              }

              &.animationed {
                animation: none;
              }
            }
          }
        </style>
        <script>
          {
            // CSSだけだと難しいのWeb Animations APIを使う
            const dotEx1 = document.querySelector("#drop .dotEx:nth-child(1)");
            const dotEx2 = document.querySelector("#drop .dotEx:nth-child(2)");
            const dot2 = dotEx2.querySelector("#drop .dotEx:nth-child(2) .dot");
            tick = () => {
              dotEx1.classList.add("animationed");
              dotEx2.classList.add("animationed");
              requestAnimationFrame(() => {
                dotEx1.classList.remove("animationed");
                dotEx2.classList.remove("animationed");

                dot2.animate(
                  [
                    { transform: "scale(0.2, 2)" },
                    { transform: "scale(1, 1)" },
                  ],
                  {
                    duration: 450,
                    easing: "cubic-bezier(0.175, 0.885, 0.32, 1.4)",
                    delay: 450,
                    fill: "both",
                  }
                );
              });
              setTimeout(tick, 2000);
            };
            tick();
          }
        </script>
      </div>
    </div>
  </body>
</html>
